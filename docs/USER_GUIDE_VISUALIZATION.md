# 推理鏈視覺化介面使用指南

## 🎯 快速開始

### 1. 查看推理鏈列表

登錄系統後，默認進入推理鏈列表頁面。

```
http://localhost:5173/
```

頁面顯示所有推理鏈，包括：
- 推理鏈名稱
- 描述
- 創建時間
- 操作按鈕

### 2. 查看推理鏈（只讀模式）

點擊任意推理鏈的 **「View」** 按鈕，進入視覺化查看器。

```
http://localhost:5173/view/{chain_id}
```

#### 查看器功能：

**左側面板 - 推理鏈結構**
- 🗺️ 視覺化 DAG 圖：顯示所有節點和連接關係
- 🎨 節點顏色編碼：不同類型節點用不同顏色標識
- 🔍 迷你地圖：快速導航大型推理鏈
- 📋 節點詳情：每個節點的完整配置信息

**右側面板 - 三個標籤頁**

1. **執行歷史** 📊
   - 時間線展示所有執行記錄
   - 顯示執行狀態（成功/失敗/執行中）
   - 顯示執行時間和耗時
   - 點擊「查看詳情」按鈕查看完整結果

2. **執行結果** 📝
   - 執行 ID 和狀態
   - 開始/完成時間
   - 執行耗時
   - 輸入資料（JSON 格式）
   - 執行結果（JSON 格式）
   - 錯誤資訊（如果失敗）

3. **鏈資訊** ℹ️
   - 推理鏈 ID
   - 名稱和描述
   - 是否為模板
   - 創建/更新時間
   - 節點數量

### 3. 執行推理鏈

在查看器頁面，點擊 **「執行推理鏈」** 按鈕：

1. 系統會提交執行請求
2. 自動輪詢執行狀態（每 1 秒檢查一次）
3. 執行完成後顯示成功提示
4. 自動刷新執行歷史列表
5. 執行結果會顯示在右側「執行結果」標籤

### 4. 編輯推理鏈

如果需要編輯推理鏈，返回列表頁面，點擊 **「Edit」** 按鈕。

```
http://localhost:5173/flow/{chain_id}
```

這會進入推理鏈編輯器（FlowEditor），可以：
- 添加/刪除節點
- 修改節點配置
- 連接節點
- 保存修改

## 🎨 介面元素說明

### 節點類型顏色

| 類型 | 顏色 | 圖標 | 說明 |
|------|------|------|------|
| data_input | 🟢 綠色 | 📥 | 數據輸入節點 |
| transform | 🔵 藍色 | 🔄 | 數據轉換節點 |
| calculate | 🟣 紫色 | 🧮 | 計算節點 |
| condition | 🟠 橙色 | ❓ | 條件判斷節點 |
| output | 🩷 粉色 | 📤 | 輸出節點 |

### 執行狀態顏色

| 狀態 | 顏色 | 說明 |
|------|------|------|
| completed, success | 🟢 綠色 | 執行成功 |
| failed, error | 🔴 紅色 | 執行失敗 |
| running | 🔵 藍色 | 執行中 |
| pending | ⚪ 灰色 | 等待執行 |

## 🔧 常見操作

### 查看節點配置

在左側「節點列表」卡片中：
1. 找到目標節點
2. 展開查看詳細配置
3. 配置以 JSON 格式顯示

### 查看執行歷史

在右側「執行歷史」標籤：
1. 時間線從新到舊排列
2. 顯示執行狀態和時間
3. 點擊「查看詳情」按鈕查看完整結果

### 查看執行結果

在右側「執行結果」標籤：
1. 選擇一個執行記錄（從歷史中）
2. 查看完整的輸入和輸出
3. 如果失敗，查看錯誤資訊

### 導航推理鏈圖表

- **縮放**：使用滑鼠滾輪或控制面板的 +/- 按鈕
- **平移**：按住滑鼠左鍵拖動
- **重置視圖**：點擊控制面板的「適應視圖」按鈕
- **迷你地圖**：點擊迷你地圖快速跳轉到指定區域

## 📱 快捷鍵

| 操作 | 快捷鍵 |
|------|--------|
| 縮放 | Ctrl + 滾輪 |
| 重置視圖 | 雙擊空白區域 |

## ⚠️ 注意事項

### 只讀模式限制

在視覺化查看器中：
- ❌ **不能**拖動節點
- ❌ **不能**添加/刪除節點
- ❌ **不能**修改節點連接
- ❌ **不能**編輯節點配置
- ✅ **可以**查看所有資訊
- ✅ **可以**執行推理鏈
- ✅ **可以**查看執行歷史和結果

### 編輯推理鏈

如需編輯，請使用編輯器頁面（點擊「Edit」按鈕）。

### 認證要求

所有操作都需要登錄。如果 token 過期，會自動跳轉到登錄頁面。

## 🐛 故障排除

### 問題：推理鏈無法載入

**解決方案**：
1. 檢查網路連接
2. 確認後端服務正在運行
3. 檢查推理鏈 ID 是否正確
4. 查看瀏覽器控制台錯誤訊息

### 問題：執行無法啟動

**解決方案**：
1. 確認推理鏈結構正確（無循環依賴）
2. 檢查節點配置是否完整
3. 查看後端日誌錯誤訊息

### 問題：執行歷史為空

**解決方案**：
1. 確認推理鏈已被執行過
2. 檢查資料庫連接
3. 嘗試手動執行一次推理鏈

## 📚 更多資訊

- **完整實現說明**：`IMPLEMENTATION_SUMMARY.md`
- **詳細文檔**：`docs/frontend-visualization-completed.md`
- **API 文檔**：`docs/specs/api.md`
- **系統架構**：`docs/architecture/system-architecture.md`

## 💡 提示

1. **大型推理鏈**：使用迷你地圖快速導航
2. **執行監控**：執行推理鏈後，系統會自動輪詢狀態
3. **錯誤排查**：執行失敗時，查看執行結果標籤的錯誤資訊
4. **JSON 格式**：所有配置和結果都以 JSON 格式展示，便於複製和分析
